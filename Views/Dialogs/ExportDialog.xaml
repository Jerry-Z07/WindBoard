<UserControl x:Class="WindBoard.Views.Dialogs.ExportDialog"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             MinWidth="520"
             MaxWidth="640">
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <TextBlock Text="导出"
                   FontSize="20"
                   FontWeight="SemiBold"
                   Foreground="#111"
                   Margin="0,0,0,16"/>

        <!-- 导出范围 -->
        <StackPanel Grid.Row="1" Margin="0,0,0,12">
            <TextBlock Text="导出范围" FontWeight="SemiBold" Foreground="#444" Margin="0,0,0,8"/>
            <StackPanel Orientation="Horizontal">
                <RadioButton Name="RbCurrentPage" Content="当前页" IsChecked="True"
                             GroupName="ExportScope" Margin="0,0,24,0"
                             Checked="Scope_Changed"/>
                <RadioButton Name="RbAllPages" Content="全部页面"
                             GroupName="ExportScope"
                             Checked="Scope_Changed"/>
                <TextBlock Name="TxtPageCount" Text="(3页)" Foreground="#888" VerticalAlignment="Center" Margin="4,0,0,0"/>
            </StackPanel>
        </StackPanel>

        <!-- 导出格式选项卡 -->
        <TabControl Grid.Row="2" Name="FormatTabControl" SelectionChanged="FormatTab_SelectionChanged">
            <!-- 图片选项卡 -->
            <TabItem Header="图片">
                <Grid Margin="0,16,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- 图片格式 -->
                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="格式" FontWeight="SemiBold" Foreground="#444" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton Name="RbPng" Content="PNG" IsChecked="True"
                                         GroupName="ImageFormat" Margin="0,0,24,0"
                                         Checked="ImageFormat_Changed"/>
                            <RadioButton Name="RbJpg" Content="JPG"
                                         GroupName="ImageFormat"
                                         Checked="ImageFormat_Changed"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- 分辨率 -->
                    <StackPanel Grid.Row="1" Margin="0,0,0,12">
                        <TextBlock Text="分辨率" FontWeight="SemiBold" Foreground="#444" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBox Name="TxtWidth" Text="1920" Width="80" Margin="0,0,8,0"
                                     materialDesign:HintAssist.Hint="宽度"
                                     TextChanged="Resolution_Changed"/>
                            <TextBlock Text="×" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBox Name="TxtHeight" Text="1080" Width="80"
                                     materialDesign:HintAssist.Hint="高度"
                                     TextChanged="Resolution_Changed"/>
                            <TextBlock Text="px" VerticalAlignment="Center" Margin="8,0,0,0" Foreground="#888"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- 分辨率预设 -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,12">
                        <TextBlock Text="预设:" VerticalAlignment="Center" Foreground="#666" Margin="0,0,8,0"/>
                        <Button Content="1080p" Style="{StaticResource MaterialDesignOutlinedButton}"
                                Padding="12,4" Margin="0,0,8,0" Click="Preset1080p_Click"/>
                        <Button Content="2K" Style="{StaticResource MaterialDesignOutlinedButton}"
                                Padding="12,4" Margin="0,0,8,0" Click="Preset2K_Click"/>
                        <Button Content="4K" Style="{StaticResource MaterialDesignOutlinedButton}"
                                Padding="12,4" Click="Preset4K_Click"/>
                    </StackPanel>

                    <!-- 保持比例 -->
                    <CheckBox Grid.Row="3" Name="ChkKeepAspectRatio" Content="保持笔迹宽高比" IsChecked="True"/>
                </Grid>
            </TabItem>

            <!-- PDF 选项卡 -->
            <TabItem Header="PDF">
                <Grid Margin="0,16,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- 纸张方向 -->
                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="纸张方向" FontWeight="SemiBold" Foreground="#444" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton Name="RbOrientAuto" Content="自动" IsChecked="True"
                                         GroupName="PdfOrientation" Margin="0,0,24,0"/>
                            <RadioButton Name="RbOrientLandscape" Content="横向"
                                         GroupName="PdfOrientation" Margin="0,0,24,0"/>
                            <RadioButton Name="RbOrientPortrait" Content="纵向"
                                         GroupName="PdfOrientation"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- 缩放模式 -->
                    <StackPanel Grid.Row="1" Margin="0,0,0,12">
                        <TextBlock Text="缩放模式" FontWeight="SemiBold" Foreground="#444" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton Name="RbFitPage" Content="适合页面（保持比例）" IsChecked="True"
                                         GroupName="PdfScaleMode" Margin="0,0,24,0"/>
                            <RadioButton Name="RbFillPage" Content="填满页面"
                                         GroupName="PdfScaleMode"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- DPI -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal">
                        <TextBlock Text="渲染质量 (DPI):" VerticalAlignment="Center" Foreground="#666" Margin="0,0,8,0"/>
                        <ComboBox Name="CboPdfDpi" SelectedIndex="1" Width="100">
                            <ComboBoxItem Content="96 (快速)"/>
                            <ComboBoxItem Content="150 (标准)"/>
                            <ComboBoxItem Content="300 (高清)"/>
                        </ComboBox>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- WBI 选项卡 -->
            <TabItem Header="WBI">
                <Grid Margin="0,16,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- 压缩级别 -->
                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="压缩级别" FontWeight="SemiBold" Foreground="#444" Margin="0,0,0,8"/>
                        <ComboBox Name="CboCompression" SelectedIndex="2" Width="160">
                            <ComboBoxItem Content="无压缩（最快）"/>
                            <ComboBoxItem Content="快速压缩"/>
                            <ComboBoxItem Content="标准压缩（推荐）"/>
                            <ComboBoxItem Content="最大压缩（最小）"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- 包含图片附件 -->
                    <StackPanel Grid.Row="1" Margin="0,0,0,12">
                        <CheckBox Name="ChkIncludeImages" Content="包含图片附件原始文件" IsChecked="True"
                                  Checked="WbiOptions_Changed" Unchecked="WbiOptions_Changed"/>
                        <TextBlock Text="视频和链接仅保存路径/URL" Foreground="#888" FontSize="12" Margin="24,4,0,0"/>
                    </StackPanel>

                    <!-- 说明 -->
                    <Border Grid.Row="2" Background="#FFF8E1" CornerRadius="8" Padding="12">
                        <StackPanel>
                            <TextBlock Text="WBI 格式说明" FontWeight="SemiBold" Foreground="#F57C00"/>
                            <TextBlock TextWrapping="Wrap" Foreground="#666" Margin="0,4,0,0"
                                       Text="WBI 是 WindBoard 专用格式，可通过「导入」功能完整恢复导出时的画布状态（包括笔迹、附件、视图位置等）。"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- 预估大小 -->
        <Border Grid.Row="3" Background="#F5F5F5" CornerRadius="8" Padding="12" Margin="0,16,0,0">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="预估文件大小:" Foreground="#666" VerticalAlignment="Center"/>
                <TextBlock Name="TxtEstimatedSize" Text="~2.3 MB" FontWeight="SemiBold" Margin="8,0,0,0" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- 按钮 -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button Style="{StaticResource MaterialDesignOutlinedButton}"
                    MinWidth="90"
                    Margin="0,0,8,0"
                    Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}">
                取消
            </Button>
            <Button Name="BtnExport"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    MinWidth="120"
                    Click="Export_Click">
                导出...
            </Button>
        </StackPanel>
    </Grid>
</UserControl>
